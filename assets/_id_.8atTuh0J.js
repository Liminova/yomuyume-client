import{_ as A}from"./newRoute.ZmWi6bHh.js";import{f as P,_ as D}from"./ImagePoly.vue.-mgxmTYa.js";import{s as F,C as N,r as a,n as V,f as $,o as v,c as p,b as x,u as t,w as U,a as s,t as _,J as j,H as w,d as h,F as M,D as O}from"./entry.ZmpWMgT3.js";import{u as b}from"./text-button.1k7WlBff.js";import{d as R}from"./Toggle.ltk3lzMs.js";import{i as S}from"./index.9KgkEnz4.js";import{_ as z}from"./NavDrawerWrapper.vue.Q-ElvCcJ.js";import"./ripple.uo11bOlx.js";import"./md-focus-ring.EDTuL-Ow.js";import"./form-label-activation.WOp997Gu.js";import"./NavDrawer.vue.LXVGdHxZ.js";import"./NavEntry.vue.qVp9iCk1.js";import"./nuxt-link.QBoXYOtL.js";import"./ThemeToggle.9AKhojbB.js";import"./changeTheme.l_0xQP93.js";import"./TopBar.vue.0MwlbhhK.js";import"./FilterBar.vue.dVShltxY.js";import"./LogoAndTitle.kwGNx0Nz.js";import"./NavToggleIcon.ZIFwaBKs.js";import"./UserAvatar.vue.XQ1szWa1.js";const H={class:"mt-3 px-0 lg:mt-0 lg:pl-0 lg:pr-3"},J={class:"mb-7 px-7 lg:px-0"},q={class:"text-6xl font-semibold"},G={key:0,class:"mt-7 text-justify"},K={class:"my-7 flex w-full grow-[100] flex-row items-center justify-center gap-7"},Q=["id"],xe=F({__name:"[id]",setup(W){const g=N().params.id,f=Array.isArray(g)?g[0]:g,c=a(""),E=a(5e3),r=a({}),i=a(!1),n=a(!1),m=a(0),u=a(0);(async()=>{const{data:e}=await S.title(f);if(e===void 0){await V("/404");return}r.value=e,document.title=e.title,i.value=e.is_favorite??!1,n.value=e.is_bookmark??!1,m.value=e.favorites??0,u.value=e.bookmarks??0})();async function C(){const{message:e,ok:o}=await b.favorite(f,i.value?"DELETE":"PUT");c.value=e,o&&(i.value=!i.value,m.value=m.value+(i.value?-1:1))}async function I(){const{message:e,ok:o}=await b.bookmark(f,n.value?"DELETE":"PUT");c.value=e,o&&(u.value=u.value+(n.value?-1:1),n.value=!n.value)}const y=a(0),T=new IntersectionObserver(e=>{for(const o of e){if(!o.isIntersecting)continue;const d=o.target;y.value=r.value.pages.findIndex(k=>k.id===d.id)}},{root:null,rootMargin:"0px",threshold:.5});async function B(e){const{ok:o,message:d}=await b.progress(f,e);o||(c.value=d)}$(()=>{R(B,3e4)(y.value)});function L(e){const o=document.getElementById(e);o!==null&&T.observe(o)}return(e,o)=>{const d=A,k=D;return v(),p("div",null,[x(d,{message:t(c),timeout:t(E),onClose:o[0]||(o[0]=l=>c.value="")},null,8,["message","timeout"]),x(z,null,{default:U(()=>[s("div",H,[s("div",J,[s("div",q,_(t(r).title),1),t(r).description?(v(),p("div",G,_(t(r).description),1)):j("",!0)]),s("div",K,[s("md-text-button",{class:"scale-125",onClick:I},[s("i",{class:w(["fa-bookmark",{"fa-solid":t(n),"fa-light":!t(n)}])},null,2),h(" "+_(t(u)>0?t(u):""),1)]),s("md-text-button",{class:"scale-125",onClick:C},[s("i",{class:w(["fa-heart",{"fa-solid":t(i),"fa-light":!t(i)}])},null,2),h(" "+_(t(m)>0?t(m):""),1)])]),(v(!0),p(M,null,O(t(r).pages,l=>(v(),p("div",{key:l.id,id:l.id,class:"mx-auto max-w-[700px]"},[x(k,{onLoaded:Y=>L(l.id),image:{src:t(P).page(l.id),format:l.format}},null,8,["onLoaded","image"])],8,Q))),128))])]),_:1})])}}});export{xe as default};
